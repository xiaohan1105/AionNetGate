<Page x:Class="AionGate.Admin.Pages.ShopManagementPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:ui="http://schemas.modernwpf.com/2019"
      Title="å•†åŸŽç®¡ç†">

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- å·¥å…·æ  -->
        <Border Grid.Row="0" Style="{StaticResource CardStyle}">
            <StackPanel Orientation="Horizontal" Spacing="12">
                <Button Content="âž• æ·»åŠ å•†å“" Style="{StaticResource AccentButtonStyle}"
                        Click="AddItem_Click"/>
                <Button Content="ðŸ“Š é”€å”®æŠ¥è¡¨" Click="SalesReport_Click"/>
                <Button Content="ðŸ’° æ”¶å…¥ç»Ÿè®¡" Click="RevenueStats_Click"/>
                <Button Content="ðŸ”„ åˆ·æ–°åº“å­˜" Click="RefreshStock_Click"/>
                <Separator/>
                <ComboBox x:Name="CategoryFilter" Width="120" SelectedIndex="0">
                    <ComboBoxItem Content="å…¨éƒ¨åˆ†ç±»"/>
                    <ComboBoxItem Content="è£…å¤‡"/>
                    <ComboBoxItem Content="æ¶ˆè€—å“"/>
                    <ComboBoxItem Content="ææ–™"/>
                    <ComboBoxItem Content="æ—¶è£…"/>
                    <ComboBoxItem Content="åéª‘"/>
                    <ComboBoxItem Content="å® ç‰©"/>
                    <ComboBoxItem Content="ç¤¼åŒ…"/>
                    <ComboBoxItem Content="VIP"/>
                </ComboBox>
                <CheckBox x:Name="OnlyActiveCheck" Content="ä»…æ˜¾ç¤ºä¸Šæž¶" IsChecked="True"/>
            </StackPanel>
        </Border>

        <!-- å•†å“åˆ—è¡¨ -->
        <Grid Grid.Row="1" Margin="0,8,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- å·¦ä¾§ï¼šå•†å“è¡¨æ ¼ -->
            <Border Grid.Column="0" Style="{StaticResource CardStyle}" Margin="0,0,8,0">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Text="ðŸ›’ å•†å“åˆ—è¡¨" FontSize="16" FontWeight="Bold"
                               Margin="0,0,0,12"/>

                    <DataGrid Grid.Row="1" x:Name="ShopItemsDataGrid"
                              AutoGenerateColumns="False"
                              IsReadOnly="True"
                              SelectionMode="Single"
                              SelectionChanged="ItemSelected_Changed">

                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="60"/>
                            <DataGridTextColumn Header="å•†å“åç§°" Binding="{Binding Name}" Width="*"/>

                            <DataGridTemplateColumn Header="ç±»åž‹" Width="80">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding TypeName}"
                                                   Foreground="{Binding TypeColor}"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTextColumn Header="ä»·æ ¼" Binding="{Binding Price}" Width="80"/>
                            <DataGridTextColumn Header="åº“å­˜" Binding="{Binding Stock}" Width="80"/>
                            <DataGridTextColumn Header="å·²å”®" Binding="{Binding SoldCount}" Width="80"/>

                            <DataGridTemplateColumn Header="çŠ¶æ€" Width="80">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Border Background="{Binding StatusColor}" CornerRadius="4"
                                                Padding="6,2">
                                            <TextBlock Text="{Binding StatusText}" Foreground="White"
                                                       FontSize="11" TextAlignment="Center"/>
                                        </Border>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTemplateColumn Header="æ ‡ç­¾" Width="100">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" Spacing="4">
                                            <Border Background="#F44336" CornerRadius="3" Padding="4,2"
                                                    Visibility="{Binding IsHotVisible}">
                                                <TextBlock Text="ðŸ”¥çƒ­å–" Foreground="White" FontSize="10"/>
                                            </Border>
                                            <Border Background="#4CAF50" CornerRadius="3" Padding="4,2"
                                                    Visibility="{Binding IsNewVisible}">
                                                <TextBlock Text="âœ¨æ–°å“" Foreground="White" FontSize="10"/>
                                            </Border>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </Border>

            <!-- å³ä¾§ï¼šå•†å“è¯¦æƒ…å’Œæ“ä½œ -->
            <Border Grid.Column="1" Style="{StaticResource CardStyle}">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel x:Name="ItemDetailsPanel" Spacing="12">
                        <TextBlock Text="ðŸ“¦ å•†å“è¯¦æƒ…" FontSize="16" FontWeight="Bold"/>

                        <StackPanel x:Name="DetailsContent" Spacing="12">
                            <!-- å•†å“å›¾ç‰‡ -->
                            <Border Background="#F5F5F5" CornerRadius="8" Height="150"
                                    HorizontalAlignment="Center" Width="150">
                                <Image x:Name="ItemImage" Stretch="Uniform"/>
                            </Border>

                            <!-- åŸºæœ¬ä¿¡æ¯ -->
                            <TextBox x:Name="ItemNameBox" ui:ControlHelper.Header="å•†å“åç§°"/>
                            <TextBox x:Name="ItemDescBox" ui:ControlHelper.Header="å•†å“æè¿°"
                                     TextWrapping="Wrap" AcceptsReturn="True" Height="80"/>
                            <TextBox x:Name="GameItemIdBox" ui:ControlHelper.Header="æ¸¸æˆç‰©å“ID"/>
                            <TextBox x:Name="QuantityBox" ui:ControlHelper.Header="æ•°é‡"/>

                            <!-- ä»·æ ¼è®¾ç½® -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBox Grid.Column="0" x:Name="PriceBox"
                                         ui:ControlHelper.Header="ä»·æ ¼" Margin="0,0,4,0"/>
                                <TextBox Grid.Column="1" x:Name="OriginalPriceBox"
                                         ui:ControlHelper.Header="åŽŸä»·ï¼ˆå¯é€‰ï¼‰" Margin="4,0,0,0"/>
                            </Grid>

                            <!-- åº“å­˜å’Œé™è´­ -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBox Grid.Column="0" x:Name="StockBox"
                                         ui:ControlHelper.Header="åº“å­˜(-1=æ— é™)" Margin="0,0,4,0"/>
                                <TextBox Grid.Column="1" x:Name="LimitBox"
                                         ui:ControlHelper.Header="é™è´­(0=ä¸é™)" Margin="4,0,0,0"/>
                            </Grid>

                            <!-- å¼€å…³é€‰é¡¹ -->
                            <CheckBox x:Name="IsActiveCheck" Content="ä¸Šæž¶é”€å”®"/>
                            <CheckBox x:Name="IsHotCheck" Content="ðŸ”¥ çƒ­å–æ ‡è®°"/>
                            <CheckBox x:Name="IsNewCheck" Content="âœ¨ æ–°å“æ ‡è®°"/>

                            <!-- æ“ä½œæŒ‰é’® -->
                            <StackPanel Spacing="8" Margin="0,12,0,0">
                                <Button Content="ðŸ’¾ ä¿å­˜æ›´æ”¹" Style="{StaticResource AccentButtonStyle}"
                                        Click="SaveItem_Click" HorizontalAlignment="Stretch"/>
                                <Button Content="ðŸ—‘ï¸ åˆ é™¤å•†å“" Click="DeleteItem_Click"
                                        Background="#F44336" Foreground="White"
                                        HorizontalAlignment="Stretch"/>
                                <Separator/>
                                <Button Content="ðŸ“Š æŸ¥çœ‹é”€å”®æ•°æ®" Click="ViewSales_Click"
                                        HorizontalAlignment="Stretch"/>
                                <Button Content="ðŸ“¦ è°ƒæ•´åº“å­˜" Click="AdjustStock_Click"
                                        HorizontalAlignment="Stretch"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- æ— é€‰ä¸­çŠ¶æ€ -->
                        <TextBlock x:Name="NoSelectionText" Text="ðŸ‘ˆ è¯·ä»Žå·¦ä¾§é€‰æ‹©å•†å“"
                                   TextAlignment="Center" Opacity="0.5" Margin="0,40,0,0"
                                   Visibility="Visible"/>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>
    </Grid>
</Page>
